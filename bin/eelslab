##!/usr/bin/python

import argparse

import os, shutil
import eelslab
import eelslab.Release
eelslab_module_path=os.path.dirname(eelslab.__file__)

import matplotlib as mpl

if os.name in ['nt','dos']:
    ipy_dir=os.path.expanduser('~/_ipython')
else:
    ipy_dir=os.path.expanduser('~/.ipython')

if not os.path.exists(ipy_dir):
    os.mkdir(ipy_dir)
shutil.copy('%s/ipython_profile/ipy_profile_eelslab.py'%eelslab_module_path,ipy_dir)

parser = argparse.ArgumentParser(add_help = True, 
version = eelslab.Release.version)
# The -wthread forces matplotlib to use the WXAgg backend
# This is necessary to support traits visualisation
parser.add_argument('-backend', action="store", dest='backend', choices = (
'gthread', 'qthread', 'q4thread', 'wthread'), default = 'wthread')
# If the headless argument is passed, no threading is used and the backend
# is defined by matplotlibrc, that for a headless system should be 
# Agg or similar.
parser.add_argument('-headless', action="store_true", default=False)
args = parser.parse_args()
backend = (' -' + args.backend if args.headless is False else '')
os.system('ipython%s -pylab -p eelslab' % backend)